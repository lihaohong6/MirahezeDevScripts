(function(E){E.loader.impl(function(){return["ext.gadget.store.StatCalc@d1806b75",function(S,C,I,j){const m=n=>Object.is(n,-0)?"-0":n,b={"+":{func:(n,a)=>`${m(Number(n)+Number(a))}`,precedence:1,associativity:"left",arity:2},"-":{func:(n,a)=>`${m(Number(n)-Number(a))}`,precedence:1,associativity:"left",arity:2},"*":{func:(n,a)=>`${m(Number(n)*Number(a))}`,precedence:2,associativity:"left",arity:2},"/":{func:(n,a)=>`${m(Number(n)/Number(a))}`,precedence:2,associativity:"left",arity:2},"%":{func:(n,a)=>`${m(Number(n)%Number(a))}`,precedence:2,associativity:"left",arity:2},"^":{func:(n,a)=>`${m(Math.pow(Number(n),Number(a)))}`,precedence:3,associativity:"right",arity:2}},w=Object.keys(b),N={min:{func:(n,a)=>`${m(Math.min(Number(n),Number(a)))}`,arity:2},max:{func:(n,a)=>`${m(Math.max(Number(n),Number(a)))}`,arity:2},sin:{func:n=>`${m(Math.sin(Number(n)))}`,arity:1},cos:{func:n=>`${m(Math.cos(Number(n)))}`,arity:1},tan:{func:n=>`${m(Math.tan(Number(n)))}`,arity:1},log:{func:n=>`${Math.log(Number(n))}`,arity:1}},A=Object.keys(N),g=n=>n[n.length-1];function M(n){const a=(function(y){const o=y.replace(/\s+/g," "),e=[];let i="",r="";for(let s=0;s<o.length;s++){const t=o.charAt(s),f=o.charAt(s-1),l=o.charAt(s+1),u=g(e),d=r!=="";if(/\d/.test(t)||(t==="+"||t==="-")&&!d&&(u===void 0||u===","||u==="("||w.includes(u))&&/\d/.test(l))r+=t;else if(t==="."){if(d&&r.includes("."))throw new Error(`Double '.' in number: '${r}${t}'`);r+=t}else if(t===" "){if(/\d/.test(f)&&/\d/.test(l))throw new Error(`Space in number: '${r}${t}${l}'`)}else if(A.includes(i+t))i+=t,A.includes(i+l)||(e.push(i),i="");else if(w.includes(t)||t==="("||t===")"||t===","){if(w.includes(t)&&!d&&w.includes(u))throw new Error(`Consecutive operators: '${u}${t}'`);d&&e.push(r),e.push(t),r=""}else i+=t}if(i!=="")throw new Error(`Invalid characters: '${i}'`);return r!==""&&e.push(r),e[0]!=="+"&&e[0]!=="-"||e.unshift("0"),e})(n),v=(function(y){const o=new Array,e=new Array;for(const i of y)if(N[i]!==void 0)e.push(i);else if(i===","){for(;e.length>0&&g(e)!=="(";)o.push(e.pop());if(e.length===0)throw new Error("Misplaced ','")}else if(b[i]!==void 0){const r=i;for(;e.length>0&&g(e)!==void 0&&g(e)!=="("&&(b[g(e)].precedence>b[r].precedence||b[r].precedence===b[g(e)].precedence&&b[r].associativity==="left");)o.push(e.pop());e.push(r)}else if(i==="(")e.push(i);else if(i===")"){for(;e.length>0&&g(e)!=="(";)o.push(e.pop());if(!(e.length>0&&g(e)==="("))throw new Error("Parentheses mismatch");e.pop(),N[g(e)]!==void 0&&o.push(e.pop())}else o.push(i);for(;e.length>0;){if(g(e)==="(")throw new Error("Parentheses mismatch");o.push(e.pop())}return o})(a);return(function(y){const o=new Array,e={...b,...N};for(const i of y){const r=e[i];if(r!==void 0){const s=[];for(let t=0;t<r.arity;t++)s.push(o.pop());o.push(r.func(...s.reverse()))}else o.push(i)}if(o.length>1)throw new Error("Insufficient operators");return Number(o[0])})(v)}(function(){const n=["localhost:","safemode=","action=submit"].some(v=>window.location.href.includes(v));function a(v,y){let o;return function(...e){clearTimeout(o),o=setTimeout(()=>v.apply(this,e),y)}}document.querySelectorAll(".stat-display").forEach(v=>{const y=new Map,o=v.querySelectorAll(".stat-controls");if(o.length===0)return;n&&console.log("Controllers found: ",o);for(const r of o){const s=r.getAttribute("data-levels")?.split(",")?.map(c=>(c||"").trim())?.filter(c=>c&&c!=="");if(!s)return;const t=document.createElement("input");t.type="range",t.classList.add("stat-slider"),t.min="0",t.max=(s.length-1).toString(),t.value="0",r.appendChild(t);const f=document.createElement("input");f.type="text",f.classList.add("stat-input"),r.appendChild(f);const l=r.getAttribute("data-name")||"main",u=c=>{c=Math.max(0,Math.min(c,s.length-1)),y.set(l,c),t&&(t.value=c.toString()),f&&(f.value=s[c].toString())},d=(c,h=!1)=>{u(c),h?a(i,5)():i()};t.addEventListener("input",c=>{const h=c.currentTarget,p=parseInt(h.value);d(p,!1)}),f.addEventListener("change",c=>{const h=c.currentTarget.value.trim(),p=s.indexOf(h);d(p!==-1?p:parseInt(t.value))}),u(0)}const e=v.querySelectorAll(".stat-value");function i(){e.forEach(r=>(function(s,t){const f=new Map;if(t.forEach((l,u)=>{for(const d of["","1","2","3","4","5"]){const c=`data-${u}${d}-values`,h=s.getAttribute(c);if(h){const p=h.split(",")[l]||"";f.set(u+d,p)}}}),n&&console.log("Parsed data: ",f),f.size!=1){if(f.size>1){let l=s.getAttribute("data-formula");if(!l)return;const u=Array.from(f.entries()),d=u.slice().sort(([p],[$])=>$.length-p.length);for(const[p,$]of d)l=l?.replaceAll(p,$);n&&(console.log("Entries",u),console.log("New formula",l));const c=parseInt(s.getAttribute("data-precision")||"0")||0,h=M(l).toFixed(c);return s.textContent=h.toString(),void(s.title=u.map(([p,$])=>`${p}: ${$}`).join(`
`)+`
`+l)}for(const[l,u]of t.entries()){const d=`data-${l}-children`,c=s.getAttribute(d);if(!c)continue;const h=c.split(",");let p=parseInt(h[u])||0;return p-=1,void Array.from(s.children).forEach(($,x)=>{$.style.display=x===p?"":"none"})}}else s.textContent=f.values().next().value})(r,y))}i()})})()},{css:[]},{},{},null]})})(mediaWiki);
