[10,828].includes(mw.config.get("wgNamespaceNumber"))&&null!==mw.config.get("wgUserId")&&mw.loader.using("@wikimedia/codex").then(e=>{const i=e("vue"),t=e("@wikimedia/codex");mw.hook("wikipage.content").add(e=>{e&&e.find(".how-to-export").each((e,l)=>{const a=document.createElement("div");l.append(a),i.createMwApp({data:()=>({wikis:[],selectedWikiUrl:null,templateName:mw.config.get("wgPageName")}),template:'\n          <hr style="margin: 10px 0;" />\n          <b>Pre-fill import parameters</b>\n          <div style="display: flex; gap: 0.25em;">\n          <cdx-select\n          v-model:selected="selectedWikiUrl"\n          :menu-items="wikis"\n          default-label="Select wiki"\n          @click="loadWikis"\n          @update:selected="saveSelectedWiki"\n          />\n          <cdx-button\n          action="progressive"\n          :disabled="!selectedWikiUrl"\n          @click="openImportPage"\n          >Open</cdx-button>\n          </div>\n          <p>Clicking the "Open" button will open the import page on the selected wiki in a new tab. Please click "Import" on the import page to complete the installation.</p>\n          ',methods:{openImportPage(){if(!this.selectedWikiUrl)return;const e=new URL(this.selectedWikiUrl+"/wiki/Special:Import");e.searchParams.set("source","interwiki"),e.searchParams.set("interwiki","dev"),e.searchParams.set("frompage",this.templateName),e.hash="mw-import-interwiki-form";const i=window.open(e.href,"_blank");i&&i.focus()},loadWikis(){(new mw.Api).get({action:"query",format:"json",meta:"globaluserinfo",formatversion:"2",guiprop:"groups|unattached|merged"}).then(e=>{this.wikis=e.query.globaluserinfo.merged.filter(e=>e.groups&&e.groups.includes("sysop")).map(e=>({label:new URL(e.url).hostname,value:e.url}))}).catch(e=>{mw.notify("importButton: Failed to load wikis!",{type:"error"}),mw.log.error("Failed to load wikis",e),this.wikis=[{label:"Error loading wikis",value:"",disabled:!0}]})},saveSelectedWiki(){const e=this.wikis.find(e=>e.value===this.selectedWikiUrl);e&&mw.storage.set("template-installer-selected-wiki",JSON.stringify({label:e.label,value:e.value}))}},mounted(){const e=mw.storage.get("template-installer-selected-wiki");if(e){const i=JSON.parse(e);this.wikis.push({label:i.label,value:i.value}),this.selectedWikiUrl=i.value}this.wikis.push({label:"Loading...",value:"",disabled:!0})}}).component("cdx-button",t.CdxButton).component("cdx-select",t.CdxSelect).mount(a)})})});
