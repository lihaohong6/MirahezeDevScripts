(function(){const i=["localhost:","safemode=","action=submit"].some(o=>window.location.href.includes(o)),s={},c={};function u(o,r,t){i&&console.log(`Group ${o} option ${r} selected with focus ${t}`);const e=s[o]||[];for(const{el:n,option:l}of e)n.classList.toggle("tab-button-selected",l===r),n.ariaSelected=l===r,n.tabIndex=l===r?0:-1;t!==void 0&&e[t].el.focus();const a=c[o]||[];for(const{el:n,option:l}of a)n.classList.toggle("tab-panel-hidden",l!==r)}function d(o,r,t){const e=s[r];function a(l){return l<0?l+e.length:l>=e.length?l-e.length:l}let n;switch(o.key){case"ArrowUp":case"ArrowLeft":n=t-1;break;case"ArrowDown":case"ArrowRight":n=t+1;break;case"Home":n=0;break;case"End":n=e.length-1;break}n!==void 0&&(i&&console.log(`Keypress ${o.key} leads to new button index ${n}`),n=a(n),u(r,e[n].option,n),o.stopPropagation(),o.preventDefault())}function p(){const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return Array.from({length:10},()=>o[Math.floor(Math.random()*o.length)]).join("")}function f(o){return o.dataset.group||o.closest("[data-group]").dataset.group||void 0}function h(){let o=window.location.hash;o&&(o=decodeURIComponent(o.slice(1)).replace(/ /g,"_")),document.querySelectorAll(".tab-group-container").forEach(t=>{t.dataset.group||(t.dataset.group=p())}),document.querySelectorAll(".tab-button-container, .tab-panel-container").forEach(t=>{t.querySelectorAll(".tab-button, .tab-panel").forEach((e,a)=>{e.dataset.option||(e.dataset.option=a)})}),document.querySelectorAll(".tab-button-container").forEach(t=>{t.role="tablist"});const r={};document.querySelectorAll(".tab-button").forEach(t=>{const e=f(t);if(!e)return;const a=t.dataset.option,n=t.dataset.name||t.textContent.trim();if(!a)return;s[e]||(s[e]=[]);const l=s[e].length;s[e].push({option:a,el:t}),r[e]||(r[e]=a),o&&n.replace(/ /g,"_")===o&&(r[e]=a),t.role="tab",t.tabIndex=0,t.ariaSelected="false",t.addEventListener("keydown",b=>d(b,e,l)),t.addEventListener("click",()=>u(e,a))}),document.querySelectorAll(".tab-panel").forEach(t=>{const e=f(t);if(!e)return;const a=t.dataset.option;a&&(t.role="tabpanel",t.tabIndex=0,c[e]||(c[e]=[]),c[e].push({option:a,el:t}))});for(const[t,e]of Object.entries(r))u(t,e);i&&(console.log("Found buttons: ",s),console.log("Found panels: ",c))}h()})();
