!function(){function e(e){let t=parseInt(e),n=Math.floor(t/60);t-=60*n;const o=Math.floor(n/60);return n-=60*o,0===o?`${n}:${String(t%60).padStart(2,0)}`:`${String(o).padStart(2,0)}:${n}:${String(t%60).padStart(2,0)}`}let t={mp3:!1,wav:!1,ogg:!1,flac:!0};const n={};function o(e){const n=e.search(/\.[a-zA-Z0-9]+$/i);if(-1===n)return e;const o=e.substring(n+1).toLowerCase();return!1===t[o]?e:e.replace(/wikitide\.net\/([^/]+)\/(.)\/(..)\/(\w+)\.ogg/i,"wikitide.net/$1/transcoded/$2/$3/$4.ogg/$4.ogg.mp3")}function i(t,i){const r=i.dataset,a=r.group,s="true"===r.loop,c="false"!==r.preload,l=parseFloat(r.loopStart),u=parseFloat(r.loopEnd),d=r.pauseButton,p=r.filename,m=i.querySelector(".toggle-play"),f=i.querySelector(".progress"),g=i.querySelector(".timeline");let y=parseFloat(r.volume);isNaN(y)&&(y=1);const v=i.querySelector(".volume-button"),w=i.querySelector(".volume"),S=i.querySelector(".volume-slider"),h=i.querySelector(".volume-percentage"),k=i.querySelector(".time"),L=i.querySelector(".current"),E=i.querySelector(".divider"),q=i.querySelector(".length");if(d&&"true"===d)return void m.parentElement.addEventListener("click",function(){n[a].pause()});let b=!1;function T(){m.classList.remove("pause"),m.classList.add("play")}function C(){"unloaded"===F.state()&&F.load()}function x(e){h&&(h.style.width=100*e+"%")}const F=new Howl({src:[o(r.src)],preload:c,onpause:T,onplay:function(){m.classList.remove("play"),m.classList.add("pause"),s&&0!==u&&setTimeout(I,20),(s&&0!==u||f||L)&&setTimeout(A,100)},onend:function(){s?(F.seek(0),F.play()):T()},onload:function(){k&&(L.innerText="0:00",E.innerText="/",q.innerText=e(F.duration()))},onloaderror:function(e){L&&(L.innerText="Failed to load"),console.log(e)},onvolume:function(){x(F.volume())}});function I(){const e=F.seek();e>=u&&e-u<.5&&F.seek(l),F.playing&&setTimeout(I,20)}function A(){const t=F.seek();f&&(f.style.width=t/F.duration()*100+"%"),L&&(L.innerText=e(t)),F.playing&&setTimeout(A,20)}function M(){if(p){const e="/wiki/File:"+p;return window.open(e,"_blank").focus(),!0}return!1}function j(){b?(F.mute(!1),w.classList.remove("icon-muted"),w.classList.add("icon-volume-medium")):(F.mute(!0),w.classList.add("icon-muted"),w.classList.remove("icon-volume-medium")),b=!b}x(y),F.volume(y),F.on("seek",A),m.parentElement.addEventListener("contextmenu",function(e){return e.preventDefault(),!M()}),m.parentElement.addEventListener("click",function(e){if(e.ctrlKey){if(M())return}if(C(),F.playing())F.pause();else{if(a&&"concurrent"!==a){const e=n[a];e&&e.pause(),n[a]=F}F.play()}}),g&&g.addEventListener("click",e=>{C();const t=window.getComputedStyle(g).width,n=e.offsetX/parseInt(t)*F.duration();F.seek(n)}),v&&v.addEventListener("click",j),S&&S.addEventListener("click",e=>{b&&j();const t=window.getComputedStyle(S).width,n=e.offsetX/parseInt(t);F.volume(n)})}var r,a,s;r="https://cdn.jsdelivr.net/npm/howler@2.2.4/dist/howler.min.js",a=async function(){await async function(){if(!("mediaCapabilities"in navigator))return console.warn("MediaCapabilities API not supported"),!1;const e={type:"file",audio:{contentType:'audio/ogg; codecs="opus"',channels:2,bitrate:64e3,samplerate:44100}};try{return(await navigator.mediaCapabilities.decodingInfo(e)).powerEfficient}catch(t){return console.error("Error while checking media capabilities:",t),!1}}()||(t.ogg=!0),$(".audio-player").each(i)},(s=document.createElement("script")).setAttribute("src",r),s.onload=a,document.body.appendChild(s)}();
