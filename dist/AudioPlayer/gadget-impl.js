(function(N){N.loader.impl(function(){return["ext.gadget.store.AudioPlayer@f5f074b0",function(P,W,Z,_){(function(){function k(r){let t=parseInt(r),o=Math.floor(t/60);t-=60*o;const i=Math.floor(o/60);return o-=60*i,i===0?`${o}:${String(t%60).padStart(2,0)}`:`${String(i).padStart(2,0)}:${o}:${String(t%60).padStart(2,0)}`}let L={mp3:!1,wav:!1,ogg:!1,flac:!0};const m={};function X(r){const t=r.search(/\.[a-zA-Z0-9]+$/i);if(t===-1)return r;const o=r.substring(t+1).toLowerCase();return L[o]===!1?r:r.replace(/wikitide\.net\/([^/]+)\/(.)\/(..)\/(\w+)\.ogg/i,"wikitide.net/$1/transcoded/$2/$3/$4.ogg/$4.ogg.mp3")}function z(r,t){const o=t.dataset,i=o.group,g=o.loop==="true",B=o.preload!=="false",D=parseFloat(o.loopStart),c=parseFloat(o.loopEnd),b=o.pauseButton,T=o.filename,a=t.querySelector(".toggle-play"),y=t.querySelector(".progress"),v=t.querySelector(".timeline");let u=parseFloat(o.volume);isNaN(u)&&(u=1);const $=t.querySelector(".volume-button"),d=t.querySelector(".volume"),w=t.querySelector(".volume-slider"),x=t.querySelector(".volume-percentage"),H=t.querySelector(".time"),s=t.querySelector(".current"),K=t.querySelector(".divider"),Q=t.querySelector(".length");if(b&&b==="true")return void a.parentElement.addEventListener("click",function(){m[i].pause()});let p=!1;function C(){a.classList.remove("pause"),a.classList.add("play")}function F(){e.state()==="unloaded"&&e.load()}function I(n){x&&(x.style.width=100*n+"%")}const e=new Howl({src:[X(o.src)],preload:B,onpause:C,onplay:function(){a.classList.remove("play"),a.classList.add("pause"),g&&c!==0&&setTimeout(A,20),(g&&c!==0||y||s)&&setTimeout(S,100)},onend:function(){g?(e.seek(0),e.play()):C()},onload:function(){H&&(s.innerText="0:00",K.innerText="/",Q.innerText=k(e.duration()))},onloaderror:function(n){s&&(s.innerText="Failed to load"),console.log(n)},onvolume:function(){I(e.volume())}});function A(){const n=e.seek();n>=c&&n-c<.5&&e.seek(D),e.playing&&setTimeout(A,20)}function S(){const n=e.seek();y&&(y.style.width=n/e.duration()*100+"%"),s&&(s.innerText=k(n)),e.playing&&setTimeout(S,20)}function j(){if(T){const n="/wiki/File:"+T;return window.open(n,"_blank").focus(),!0}return!1}function M(){p?(e.mute(!1),d.classList.remove("icon-muted"),d.classList.add("icon-volume-medium")):(e.mute(!0),d.classList.add("icon-muted"),d.classList.remove("icon-volume-medium")),p=!p}I(u),e.volume(u),e.on("seek",S),a.parentElement.addEventListener("contextmenu",function(n){return n.preventDefault(),!j()}),a.parentElement.addEventListener("click",function(n){if(!(n.ctrlKey&&j()))if(F(),e.playing())e.pause();else{if(i&&i!=="concurrent"){const l=m[i];l&&l.pause(),m[i]=e}e.play()}}),v&&v.addEventListener("click",n=>{F();const l=window.getComputedStyle(v).width,h=n.offsetX/parseInt(l)*e.duration();e.seek(h)}),$&&$.addEventListener("click",M),w&&w.addEventListener("click",n=>{p&&M();const l=window.getComputedStyle(w).width,h=n.offsetX/parseInt(l);e.volume(h)})}var E,q,f;E="https://cdn.jsdelivr.net/npm/howler@2.2.4/dist/howler.min.js",q=async function(){await(async function(){if(!("mediaCapabilities"in navigator))return console.warn("MediaCapabilities API not supported"),!1;const r={type:"file",audio:{contentType:'audio/ogg; codecs="opus"',channels:2,bitrate:64e3,samplerate:44100}};try{return(await navigator.mediaCapabilities.decodingInfo(r)).powerEfficient}catch(t){return console.error("Error while checking media capabilities:",t),!1}})()||(L.ogg=!0),P(".audio-player").each(z)},(f=document.createElement("script")).setAttribute("src",E),f.onload=q,document.body.appendChild(f)})()},{css:[]},{},{},null]})})(mediaWiki);
