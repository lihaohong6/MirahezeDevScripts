(function(mw){mw.loader.impl(function(){return ["ext.gadget.store.AudioPlayer@595a55b0",function($,jQuery,require,module){(function(){function F(i,e){var o=document.createElement("script");o.setAttribute("src",i),o.onload=e,document.body.appendChild(o)}function h(i){let e=parseInt(i),o=Math.floor(e/60);e-=o*60;const s=Math.floor(o/60);return o-=s*60,s===0?`${o}:${String(e%60).padStart(2,0)}`:`${String(s).padStart(2,0)}:${o}:${String(e%60).padStart(2,0)}`}async function B(){if(!("mediaCapabilities"in navigator))return console.warn("MediaCapabilities API not supported"),!1;const i={type:"file",audio:{contentType:'audio/ogg; codecs="opus"',channels:2,bitrate:64e3,samplerate:44100}};try{return(await navigator.mediaCapabilities.decodingInfo(i)).powerEfficient}catch(e){return console.error("Error while checking media capabilities:",e),!1}}let y={mp3:!1,wav:!1,ogg:!1,flac:!0};const d={};function I(i){const e=i.search(/\.[a-zA-Z0-9]+$/i);if(e===-1)return i;const o=i.substring(e+1).toLowerCase();return y[o]===!1?i:i.replace(/wikitide\.net\/([^/]+)\/(.)\/(..)\/(\w+)\.ogg/i,"wikitide.net/$1/transcoded/$2/$3/$4.ogg/$4.ogg.mp3")}function A(i,e){const o=e.dataset,s=o.group,p=o.loop==="true",O=o.preload!=="false",j=parseFloat(o.loopStart),l=parseFloat(o.loopEnd),k=o.pauseButton,L=o.filename,r=e.querySelector(".toggle-play"),f=e.querySelector(".progress"),m=e.querySelector(".timeline");parseFloat(o.volume);const E=e.querySelector(".volume-button"),u=e.querySelector(".volume"),g=e.querySelector(".volume-slider"),T=e.querySelector(".volume-percentage"),D=e.querySelector(".time"),a=e.querySelector(".current"),G=e.querySelector(".divider"),U=e.querySelector(".length");if(k&&k==="true"){r.parentElement.addEventListener("click",function(){d[s].pause()});return}let v=!1;function q(){r.classList.remove("pause"),r.classList.add("play")}function b(){t.state()==="unloaded"&&t.load()}const t=new Howl({src:[I(o.src)],preload:O,onpause:q,onplay:function(){r.classList.remove("play"),r.classList.add("pause"),p&&l!==0&&setTimeout(x,20),(p&&l!==0||f||a)&&setTimeout(S,100)},onend:function(){p?(t.seek(0),t.play()):q()},onload:function(){D&&(a.innerText="0:00",G.innerText="/",U.innerText=h(t.duration()))},onloaderror:function(n){a&&(a.innerText="Failed to load"),console.log(n)},onvolume:function(){T&&(T.style.width=t.volume()*100+"%")}});t.volume(parseFloat(o.volume));function x(){const n=t.seek();n>=l&&n-l<.5&&t.seek(j),t.playing&&setTimeout(x,20)}function S(){const n=t.seek();f&&(f.style.width=n/t.duration()*100+"%"),a&&(a.innerText=h(n)),t.playing&&setTimeout(S,20)}t.on("seek",S);function C(){if(L){const n="/wiki/File:"+L;return window.open(n,"_blank").focus(),!0}return!1}r.parentElement.addEventListener("contextmenu",function(n){return n.preventDefault(),!C()}),r.parentElement.addEventListener("click",function(n){if(!(n.ctrlKey&&C()))if(b(),t.playing())t.pause();else{if(s&&s!=="concurrent"){const c=d[s];c&&c.pause(),d[s]=t}t.play()}}),m&&m.addEventListener("click",n=>{b();const c=window.getComputedStyle(m).width,w=n.offsetX/parseInt(c)*t.duration();t.seek(w)}),E&&E.addEventListener("click",function(){v?(t.mute(!1),u.classList.remove("icon-muted"),u.classList.add("icon-volume-medium")):(t.mute(!0),u.classList.add("icon-muted"),u.classList.remove("icon-volume-medium")),v=!v}),g&&g.addEventListener("click",n=>{const c=window.getComputedStyle(g).width,w=n.offsetX/parseInt(c);t.volume(w)})}async function M(){await B()||(y.ogg=!0),$(".audio-player").each(A)}F("https://cdn.jsdelivr.net/npm/howler@2.2.4/dist/howler.min.js",M)})();},{"css":[]},{},{},null];});})(mediaWiki);